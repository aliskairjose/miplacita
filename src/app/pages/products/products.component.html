<ngx-spinner bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#fff" type="ball-spin-clockwise" [fullScreen]="true">
    <p style="color: white"> Por favor espere... </p>
</ngx-spinner>
<ngx-alerts></ngx-alerts>
<section class="section-b-space">
    <div class="container">
        <div class="d-flex">
            <!-- <form [formGroup]="searchForm" class="flex-fill theme-form"> -->
            <form class="flex-fill theme-form">
                <div class="d-flex search">
                    <div class="form-group flex-fill">
                        <div class="input-group ">
                            <div class="input-group-append">
                                <button type="buttont" class="btn" (click)="search()"><i
                                        class="fa fa-search"></i></button>
                                <!-- <span class="input-group-text">
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-search" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z"/>
                                        <path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"/>
                                    </svg>
                                </span> -->
                            </div>
                            <input [(ngModel)]="name" [ngModelOptions]="{standalone: true}"
                                class="form-control my-0 py-1" type="text" placeholder="Buscar...">
                        </div>
                        <!-- <input class="form-control" placeholder="Buscar" (change)="search($event)" /> -->
                    </div>
                    <div class="filters pb-2">
                        <!-- <div class="flex-fill mr-1">
                            <select class="form-control" formControlName="typeProduct">
                                <option value="">Tipo de producto</option>
                                <option value="" *ngFor="let type of productTypes"></option>
                            </select>
                        </div> -->
                        <div class="flex-fill">
                            <select name="model" class="form-control" [(ngModel)]="status" (change)="selectStatus()">
                                <option value="">Estado</option>
                                <option [value]="status.value" *ngFor="let status of statuses">{{status.text}}</option>
                            </select>
                        </div>
                        <div class="flex-fill" *ngIf="user.role === 'admin'">
                            <select name="model" class="form-control" [(ngModel)]="store" (change)="selectShop()">
                                <option value="">Tienda</option>
                                <option [value]="shop._id" *ngFor="let shop of shops">{{ shop.name }}</option>
                            </select>
                        </div>
                    </div>
                    <div class="d-flex flex-fill h-100 justify-content-end" *ngIf="user.role==='merchant'">
                        <a [routerLink]="[ '/pages/create-product' ]" class="btn btn-solid-purple">
                            Crear Producto
                        </a>
                    </div>
                </div>
            </form>
        </div>
        <div class="table-responsive-sm mt-3">
            <table class="table">
                <thead>
                    <tr class="table-head text-center">
                        <th *ngFor="let field of fields" scope="col">{{field}}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let product of products">
                        <td class="text-center" *ngIf="product.image.length > 0 ">
                            <img class="product-image" [src]="product.image[0]" />
                        </td>
                        <td class="text-center" *ngIf="product.image.length === 0 ">
                            <img class="product-image" [src]="standardImage" />
                        </td>
                        <td>{{ product.name }}</td>
                        <td *ngIf="user.role==='admin' "> {{ product.store ? product.store.name : 'Sin tienda' }}</td>
                        <td>{{ product.description }}</td>
                        <td class="text-center">{{ product.price | currency }}</td>
                        <td class="text-center">{{ product.tax | currency }}</td>
                        <td class="text-center">{{ product.status }}</td>

                        <td class="text-center" *ngIf="user.role==='merchant'">
                            <a [routerLink]="[ '/pages/edit-product', product._id ]"
                                class="btn btn-table-action">Editar</a>
                            <button class="btn btn-table-action" (click)="showModal(product._id)">Eliminar</button>
                        </td>
                        <td class="text-center" *ngIf="user.role==='admin'">
                            <button class="btn btn-table-action">Desactivar</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <app-custom-pagination [items]="products" [paginate]="paginate" (setPage)="setPage($event)">
        </app-custom-pagination>
    </div>
</section>